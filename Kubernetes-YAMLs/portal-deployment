kind: Deployment
apiVersion: apps/v1
metadata:
  name: portal
  namespace: app-1
  labels:
    app: portal
spec:
  replicas: 1
  selector:
    matchLabels:
      app: portal
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: portal
    spec:
      volumes:
        - name: portal-volume
          persistentVolumeClaim:
            claimName: portal-bucket-pvc
        - name: tz-config
          hostPath:
            path: /usr/share/zoneinfo/Asia/Dhaka
            type: File
      containers:
        - name: portal
          image: >-
            registry.project.com:5000/portal:69e19ba4fcf350c3111b0f96b74c73b9bea4c1e2
          env:
            - name: ACTIVE_PROFILE
              value: uat
            - name: SLIDER1
              value: https://portal.com/static/images/slider1.png
            - name: SLIDER1_MIN
              value: https://portal.com/static/images/slider1-min.png
            - name: SLIDER2
              value: https://portal.com/static/images/slider2.png
            - name: SLIDER2_MIN
              value: https://portal.com/static/images/slider2-min.png
            - name: PORTAL_DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: portal-db-username
            - name: PORTAL_DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: portal-db-password
            - name: TABLE_USERNAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: table-username
            - name: TABLE_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: table-password
            - name: TABLE_API_USERNAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: table-api-username
            - name: TABLE_API_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: table-api-password
            - name: USER_DATA_URL
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: user-data-url
            - name: USER_DATA_USERNAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: user-data-username
            - name: USER_DATA_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: user-data-password
            - name: TIME_INTERVAL
              value: '3'
            - name: REQUEST_NUMBER
              value: '3'
            - name: SMS_USERNAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: sms-username
            - name: SMS_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: sms-password
            - name: PAYMENT_SERVICE_FRONTEND_URL
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: payment-service-frontend-url
            - name: PAYMENT_SERVICE_BACKEND_URL
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: payment-service-backend-url
            - name: STATUS_BOOLEAN
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: status-boolean
            - name: DB_HOST
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: db-host
            - name: DB_NAME
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: db-name
            - name: DB_PORT
              valueFrom:
                secretKeyRef:
                  name: db-connection-secret
                  key: db-port
          resources: {}
          volumeMounts:
            - name: portal-volume
              mountPath: /var/uploads
              subPath: portal/uploads
            - name: tz-config
              readOnly: true
              mountPath: /etc/localtime
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          imagePullPolicy: IfNotPresent
      restartPolicy: Always
      terminationGracePeriodSeconds: 30
      dnsPolicy: ClusterFirst
      securityContext: {}
      imagePullSecrets:
        - name: regcred01
      schedulerName: default-scheduler
      hostAliases:
        - ip: 10.200.1.3
          hostnames:
            - table-data.portal.com
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 25%
      maxSurge: 25%
  revisionHistoryLimit: 10
  progressDeadlineSeconds: 600
